<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; MODFLOW 6: modelo GWF. – Tutorial: Modflow 6 + Flopy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_MF6_GWF_v1.html" rel="next">
<link href="./01_MF6_GWF_init.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02_MF6_GWF_paq.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">MODFLOW 6: modelo GWF.</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Tutorial: Modflow 6 + Flopy</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducción</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_MF6_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">MODFLOW 6: introducción.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_MF6_GWF_init.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">MODFLOW 6: inicializando una simulación.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_MF6_GWF_paq.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">MODFLOW 6: modelo GWF.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_MF6_GWF_v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">MODFLOW 6: simulación de flujo v 1.0</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_MF6_GWF_v2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">04_MF6_GWF_v2.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_MF6_GWF_wells.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">05_MF6_GWF_wells.html</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#resumen." id="toc-resumen." class="nav-link active" data-scroll-target="#resumen."><span class="header-section-number">3.1</span> Resumen.</a></li>
  <li><a href="#introducción." id="toc-introducción." class="nav-link" data-scroll-target="#introducción."><span class="header-section-number">4</span> Introducción.</a></li>
  <li><a href="#ejemplo-simulación-de-flujo-en-2d." id="toc-ejemplo-simulación-de-flujo-en-2d." class="nav-link" data-scroll-target="#ejemplo-simulación-de-flujo-en-2d."><span class="header-section-number">5</span> Ejemplo: Simulación de flujo en 2D.</a></li>
  <li><a href="#paso-1.-configuración-inicial." id="toc-paso-1.-configuración-inicial." class="nav-link" data-scroll-target="#paso-1.-configuración-inicial."><span class="header-section-number">5.1</span> Paso 1. Configuración inicial.</a></li>
  <li><a href="#paquetes." id="toc-paquetes." class="nav-link" data-scroll-target="#paquetes."><span class="header-section-number">5.2</span> Paquetes.</a></li>
  <li><a href="#paso-2.-discretización-espacial." id="toc-paso-2.-discretización-espacial." class="nav-link" data-scroll-target="#paso-2.-discretización-espacial."><span class="header-section-number">5.3</span> Paso 2. Discretización espacial.</a></li>
  <li><a href="#paso-3.-condiciones-iniciales." id="toc-paso-3.-condiciones-iniciales." class="nav-link" data-scroll-target="#paso-3.-condiciones-iniciales."><span class="header-section-number">5.4</span> Paso 3. Condiciones iniciales.</a></li>
  <li><a href="#paso-4.-condiciones-de-frontera." id="toc-paso-4.-condiciones-de-frontera." class="nav-link" data-scroll-target="#paso-4.-condiciones-de-frontera."><span class="header-section-number">5.5</span> Paso 4. Condiciones de frontera.</a></li>
  <li><a href="#paso-5.-propiedades-hidráulicas." id="toc-paso-5.-propiedades-hidráulicas." class="nav-link" data-scroll-target="#paso-5.-propiedades-hidráulicas."><span class="header-section-number">5.6</span> Paso 5. Propiedades hidráulicas.</a></li>
  <li><a href="#paso-6.-configuración-de-la-salida." id="toc-paso-6.-configuración-de-la-salida." class="nav-link" data-scroll-target="#paso-6.-configuración-de-la-salida."><span class="header-section-number">5.7</span> Paso 6. Configuración de la salida.</a></li>
  <li><a href="#paso-7.-ejecución-de-la-simulación." id="toc-paso-7.-ejecución-de-la-simulación." class="nav-link" data-scroll-target="#paso-7.-ejecución-de-la-simulación."><span class="header-section-number">5.8</span> Paso 7. Ejecución de la simulación.</a></li>
  <li><a href="#paso-8.-recuperación-y-visualización-de-los-resultados." id="toc-paso-8.-recuperación-y-visualización-de-los-resultados." class="nav-link" data-scroll-target="#paso-8.-recuperación-y-visualización-de-los-resultados."><span class="header-section-number">5.9</span> Paso 8. Recuperación y visualización de los resultados.</a>
  <ul class="collapse">
  <li><a href="#recuperación-de-la-carga-hidráulica." id="toc-recuperación-de-la-carga-hidráulica." class="nav-link" data-scroll-target="#recuperación-de-la-carga-hidráulica."><span class="header-section-number">5.9.1</span> Recuperación de la carga hidráulica.</a></li>
  <li><a href="#visualización-de-la-carga-hidráulica." id="toc-visualización-de-la-carga-hidráulica." class="nav-link" data-scroll-target="#visualización-de-la-carga-hidráulica."><span class="header-section-number">5.9.2</span> Visualización de la carga hidráulica.</a></li>
  <li><a href="#recuperación-de-la-descarga-específica." id="toc-recuperación-de-la-descarga-específica." class="nav-link" data-scroll-target="#recuperación-de-la-descarga-específica."><span class="header-section-number">5.9.3</span> Recuperación de la descarga específica.</a></li>
  <li><a href="#visualización-de-la-descarga-específica." id="toc-visualización-de-la-descarga-específica." class="nav-link" data-scroll-target="#visualización-de-la-descarga-específica."><span class="header-section-number">5.9.4</span> Visualización de la descarga específica.</a></li>
  </ul></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">6</span> Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">MODFLOW 6: modelo GWF.</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="resumen." class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="resumen."><span class="header-section-number">3.1</span> Resumen.</h2>
<p>En este documento se realiza una simulación de flujo en dos dimensiones explicando paso a paso el proceso y describiendo los paquetes del modelo GWF que son usados. Se utilizan las herramientas de flopy para facilitar el pre y postprocesamiento de la información requerida por el simulador.</p>
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
<a property="dct:title" rel="cc:attributionURL" href="https://github.com/luiggix/RTWMA/">MODFLOW 6: modelo GWF</a> by <b>Luis M. de la Cruz Salas (2025)</b> is licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">Attribution-ShareAlike 4.0 International<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a>.
</p>
</section>
<section id="introducción." class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Introducción.</h1>
<p>El modelo GWF (<em>Groundwater Flow</em>) de MODFLOW 6 es un componente principal que simula el flujo del agua subterránea en medios porosos, como acuíferos.</p>
<p>Este modelo resuelve la ecuación de flujo en tres dimensiones, permitiendo representar cómo el agua se mueve bajo tierra en función de las propiedades del subsuelo, las condiciones de frontera y las fuentes o sumideros, como recarga, pozos y ríos.</p>
<p>El modelo GWF se define dentro de una simulación general y puede conectarse con otros modelos, como el de transporte de solutos (GWT) o modelos de flujo de superficie. Esto permite construir simulaciones integradas con diferentes procesos acoplados.</p>
<p>Un modelo GWF puede ser configurado por varios paquetes. Un paquete es la parte del modelo que se ocupa de un único aspecto de la simulación.</p>
</section>
<section id="ejemplo-simulación-de-flujo-en-2d." class="level1 alert alert-block alert-info" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Ejemplo: Simulación de flujo en 2D.</h1>
<p>En este ejemplo se simula una distribución de carga hidráulica en un dominio rectangular de <span class="math inline">\(15\)</span> m <span class="math inline">\(\times\)</span> <span class="math inline">\(10\)</span> m con una sola capa con espesor de <span class="math inline">\(1\)</span> m. La carga va de <span class="math inline">\(10\)</span> m en el lado izquierdo a <span class="math inline">\(5\)</span> m en lado derecho, formando un gradiente horizontal de flujo. Los lados superior e inferior del dominio son impermeables. No hay fuentes ni sumideros. El valor de la conductividad hidráulica es constante <span class="math inline">\(k = 1.0\)</span>.</p>
</section>
<section id="paso-1.-configuración-inicial." class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="paso-1.-configuración-inicial."><span class="header-section-number">5.1</span> Paso 1. Configuración inicial.</h2>
<ul>
<li>Haremos la configuración inicial de la simulación de manera similar al ejemplo de la notebook <a href="./01_MF6_GWF_init.html">01_MF6_GWF_init.ipynb</a>.</li>
<li>En este caso agregaremos algunas opciones adicionales al solucionador IMS para ver el efecto que tiene en los archivos de entrada, particularmente en <code>flow.ims</code>, véase <strong>Iterative Model Solution</strong>, pp 225-231, en [2].</li>
<li>El espacio de trabajo donde se escriben todos los archivos será la carpeta <code>sandbox2</code>.</li>
<li>La simulación así como el modelo de flujo tendrán el nombre <code>flow</code>.</li>
<li>Todo lo anterior se realiza en la siguiente celda de código:</li>
</ul>
<div id="f38b4cc9-7c96-4052-b67d-d07a2866c517" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> flopy</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Biblioteca con algunas herramientas adicionales que se puede instalar como sigue:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#pip install git+https://github.com/luiggix/xmf6</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xmf6 </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Ruta a los ejecutables de MODFLOW 6. Opciones de SO's: linux, macos, macosarm, windows</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>exe_name <span class="op">=</span> <span class="st">"C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">luiggi</span><span class="ch">\\</span><span class="st">Documents</span><span class="ch">\\</span><span class="st">GitSites</span><span class="ch">\\</span><span class="st">xmf6</span><span class="ch">\\</span><span class="st">mf6</span><span class="ch">\\</span><span class="st">windows</span><span class="ch">\\</span><span class="st">mf6"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#exe_name = "../../../mf6/macosarm/mf6"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Configuración inicial ---</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>sim_name <span class="op">=</span> <span class="st">"flow"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>sim_ws <span class="op">=</span> <span class="st">"sandbox2"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>o_sim <span class="op">=</span> flopy.mf6.MFSimulation(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    sim_name <span class="op">=</span> sim_name,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    exe_name <span class="op">=</span> exe_name,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    sim_ws   <span class="op">=</span> sim_ws</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Tiempos de simulación ---</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>o_tdis <span class="op">=</span> flopy.mf6.ModflowTdis(</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    simulation <span class="op">=</span> o_sim,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    time_units <span class="op">=</span> <span class="st">"DAYS"</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    nper <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    perioddata <span class="op">=</span> [(<span class="fl">1.0</span>, <span class="dv">1</span>, <span class="fl">1.0</span>)],</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Solucionador numérico (IMS) ---</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>o_ims <span class="op">=</span> flopy.mf6.ModflowIms(</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    simulation          <span class="op">=</span> o_sim,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    print_option        <span class="op">=</span> <span class="st">"SUMMARY"</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    complexity          <span class="op">=</span> <span class="st">"SIMPLE"</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    outer_dvclose       <span class="op">=</span> <span class="fl">1e-4</span>,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    outer_maximum       <span class="op">=</span> <span class="dv">50</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    under_relaxation    <span class="op">=</span> <span class="st">"NONE"</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    linear_acceleration <span class="op">=</span> <span class="st">"CG"</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    inner_maximum       <span class="op">=</span> <span class="dv">30</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    inner_dvclose       <span class="op">=</span> <span class="fl">1e-6</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Modelo GWF ---</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>o_gwf <span class="op">=</span> flopy.mf6.ModflowGwf(</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    simulation <span class="op">=</span> o_sim,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    modelname <span class="op">=</span> sim_name,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    model_nam_file <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>sim_name<span class="sc">}</span><span class="ss">.nam"</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    save_flows <span class="op">=</span> <span class="va">True</span> <span class="co"># Almacena los flujos, particularmente el budget</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Escribimos los archivos ---</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>o_sim.write_simulation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model flow...
    writing model name file...</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Observación.</strong></p>
<p>Revisa los archivos generados en la carpeta <code>sandbox2</code>, particularmente el archivo <code>flow.ims</code>.</p>
</div>
</section>
<section id="paquetes." class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="paquetes."><span class="header-section-number">5.2</span> Paquetes.</h2>
<p>Para generar esta simulación se requiere de agregar paquetes al modelo GWF como se muestra en la siguiente figura, tomada de [1]:</p>
<p><img src="../figures/gwf_mf6.png" width="450px" hspace="5" vspace="5"></p>
</section>
<section id="paso-2.-discretización-espacial." class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="paso-2.-discretización-espacial."><span class="header-section-number">5.3</span> Paso 2. Discretización espacial.</h2>
<p>El dominio espacial de una simulación en MODFLOW 6 se divide en una rejilla de celdas y provee de tres paquetes diferentes (véase <strong>Chapter 3. Spatial Discretization</strong> en [1]):</p>
<ul>
<li><strong>DIS</strong>. Paquete para discretización estructurada.</li>
<li><strong>DISV</strong>. Paquete para discretización por vértices.</li>
<li><strong>DISU</strong>. Paquete para discretización NO estructurada.</li>
</ul>
<p>Solo se puede usar uno de los paquetes de discretización en una simulación con GWF.</p>
<p>La información almacenada en los paquetes de discretización es usada durante la simulación por GWF para realizar varias acciones, por ejemplo: * calcular la conductividad hidráulica entre celdas conectadas, * calcular los volúmenes de celda para los cálculos de almacenamiento, * convertir los flujos de recarga y evapotranspiración, por ejemplo de las dimensiones de L/T a L<span class="math inline">\(^3\)</span>/T.</p>
<p>Los paquetes de discretización: * contienen información acerca de las celdas, como las elevaciones superior (<code>TOP</code>) e inferior (<code>BOTTOM</code>) de la celda y las dimensiones o áreas de la celda (en vista de planta). * definen la conectividad de las celdas para describir cómo están conectadas entre sí las celdas del modelo y las propiedades geométricas de las conexiones. * En el paquete <strong>DIS</strong>, la conectividad de la celda se describe implícitamente por la estructura de la malla, las dimensiones de la celda en las direcciones de renglones y columnas, y las elevaciones de la parte superior e inferior de la celda.</p>
<p>La siguiente figura, tomada de [1], muestra un ejemplo de una malla regular en tres dimensiones en donde se definen columnas, renglones y capas.</p>
<p><img src="../figures/mesh_3D_mf6.png" width="400px" hspace="5" vspace="5" style="float: left;"></p>
<ul>
<li><p>En este ejemplo tenemos 9 columnas (<code>NROW</code>), 5 renglones (<code>NCOL</code>) y 5 capas (<code>NLAY</code>).</p></li>
<li><p>El tamaño horizontal de las celdas está definido por <span class="math inline">\(\Delta r_i\)</span> y <span class="math inline">\(\Delta c_i\)</span> (variables <code>DELR</code><span class="math inline">\(_i\)</span> y <code>DELC</code><span class="math inline">\(_i\)</span>).</p></li>
<li><p>Observa que <span class="math inline">\(\Delta r_i\)</span> se mide en la dirección de los renglones (en el eje <span class="math inline">\(x\)</span> en un sistema Cartesiano), es decir, mide el tamaño de la columna <span class="math inline">\(i\)</span>-ésima.</p></li>
<li><p>Por otro lado, <span class="math inline">\(\Delta c_i\)</span> se mide en la dirección de las columnas (en el eje <span class="math inline">\(y\)</span>), por lo que mide el tamaño del renglón <span class="math inline">\(i\)</span>-ésimo</p></li>
<li><p>Las capas se numeran empezando por la capa superior y hacia abajo.</p></li>
<li><p>Las elevaciones de las celdas se especifican en la variable <code>BOTM</code> (indica la parte inferior de cada capa).</p></li>
<li><p>La elevación de la parte superior de la primera capa se debe especificar en la variable <code>TOP</code>.</p></li>
<li><p>La información de las elevaciones se usa para calcular el espesor de las celdas.</p></li>
</ul>
<div class="alert alert-block alert-info">
<p><strong>Parámetros a usar</strong>.</p>
<ul>
<li>Para obtener el modelo del dominio rectangular requerido, una capa de <span class="math inline">\(15\)</span> m <span class="math inline">\(\times\)</span> <span class="math inline">\(10\)</span> m con un espesor de <span class="math inline">\(1\)</span> m, usaremos los parámetros <code>nrow</code>, <code>ncol</code>, <code>nlay</code>, <code>delr</code> y <code>delc</code>.</li>
<li>Para obtener la longitud correcta del dominio se debe cumplir que:
<ul>
<li><code>nrow</code> * <code>delc</code> $ = 15$,</li>
<li><code>ncol</code> * <code>delr</code> $ = 10$.</li>
</ul></li>
<li>Los parámetros <code>top</code> y <code>botm</code> deben ser tales que <code>top - botm</code> <span class="math inline">\(= 1\)</span>.</li>
<li>En la siguiente celda se definen estos parámetros para generar la malla del dominio:</li>
</ul>
</div>
<div id="171e0670-ee93-4d53-b389-1aa4de533ceb" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Discretización espacial ---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>nlay <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>nrow <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>ncol <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>delr <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>delc <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>top  <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>botm <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>o_dis <span class="op">=</span> flopy.mf6.ModflowGwfdis(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> o_gwf,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    length_units <span class="op">=</span> <span class="st">"METERS"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    nlay <span class="op">=</span> nlay,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    nrow <span class="op">=</span> nrow,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    ncol <span class="op">=</span> ncol,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    delr <span class="op">=</span> delr,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    delc <span class="op">=</span> delc,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    top  <span class="op">=</span> top,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    botm <span class="op">=</span> botm,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(o_dis)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>o_sim.write_simulation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package_name = dis
filename = flow.dis
package_type = dis
model_or_simulation_package = model
model_name = flow

Block options
--------------------
length_units
{internal}
(meters)


Block dimensions
--------------------
nlay
{internal}
(1)

nrow
{internal}
(10)

ncol
{internal}
(15)


Block griddata
--------------------
delr
{constant 1.0}

delc
{constant 1.0}

top
{constant 0.0}

botm
{constant -1.0}



writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model flow...
    writing model name file...
    writing package dis...</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Explicación</strong>.</p>
<ul>
<li>En la celda anterior se construye el objeto <code>o_dis</code> de la clase <a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.mf6.modflow.mfgwfdis.html"><code>flopy.mf6.ModflowGwfdis</code></a> para generar la información de la discretización espacial. Esta clase construye una discretiación de tipo DIS.</li>
<li>El primer parámetro en esta construcción es el objeto del modelo al que esta discretización pertenece, en este caso <code>o_gwf</code>. Posteriormente se agregan todos los parámetros de la discretización.</li>
<li>La celda anterior genera el archivo <code>flow.dis</code> con la información correspondiente a la discretización espacial, revisa este archivo en la carpeta <code>sandbox2</code>.</li>
<li>Adicionalmente, el archivo <code>flow.nam</code> es modificado agregando la información del paquete DIS, deberías ver un bloque como el siguiente en ese archivo:</li>
</ul>
<pre><code>BEGIN packages
  DIS6  flow.dis  dis
END packages</code></pre>
</div>
<p>Flopy contiene herramientas para obtener la información de la discretización espacial y hacer una gráfica del dominio. Por ejemplo:</p>
<ul>
<li><code>o_gwf.modelgrid</code>: regresa un objeto que contiene toda la información de la discretización.</li>
<li><code>o_gwf.modelgrid.extent</code>: extensión del dominio (xmin, xmax, ymin, ymax).</li>
<li><code>o_gwf.modelgrid.nrow</code>: número de renglones.</li>
<li><code>o_gwf.modelgrid.ncol</code>: número de columnas.</li>
<li><code>o_gwf.modelgrid.nlay</code>: número de capas.</li>
<li><code>o_gwf.modelgrid.delr</code>: tamaño de las celdas en dirección de los renglones (coord. <span class="math inline">\(x\)</span>, tamaño de las columas).</li>
<li><code>o_gwf.modelgrid.delc</code>: tamaño de las celdas en dirección de las columnas (coord. <span class="math inline">\(y\)</span>, tamaño de los renglones).</li>
<li><code>o_gwf.modelgrid.delz</code>: tamaño de las celdas en dirección vertical (coord. <span class="math inline">\(z\)</span>, tamaño de las capas).</li>
<li><code>o_gwf.modelgrid.top</code>: parte superior de la primera capa.</li>
<li><code>o_gwf.modelgrid.botm</code>: parte inferior de todas las celdas.</li>
<li><code>o_gwf.modelgrid.xyzcellcenters</code>: centros de las celdas de la malla</li>
</ul>
<p>Veamos como podemos obtener y usar esta información.</p>
<div id="15c218d5-37dd-4bff-97fd-978cc11ab1d9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenemos el objeto con la información de la discretización espacial</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> o_gwf.modelgrid</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>grid.extent</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Extensión del dominio (xmin, xmax, ymin, ymax)"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grid.extent[<span class="dv">0</span>], grid.extent[<span class="dv">1</span>], grid.extent[<span class="dv">2</span>], grid.extent[<span class="dv">3</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Número de renglones, columnas y capas"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grid.nrow, grid.ncol, grid.nlay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Extensión del dominio (xmin, xmax, ymin, ymax)
0.0 15.0 0.0 10.0

Número de renglones, columnas y capas
10 15 1</code></pre>
</div>
</div>
<div id="28c86c92-6b51-4d19-9db5-3181526a58f6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(grid.delr), grid.delr)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.delr es un numpy.ndarray 1D de tamaño ncol</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.delc es un numpy.ndarray 1D de tamaño nrow</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.delz es un numpy.ndarray 3D de tamaño nlay x ncol x nrow</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Usamos la función xmf6.info_array() para imprimir las propiedades de arreglos de numpy</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">grid.delr ="</span>, grid.delr[<span class="dv">0</span>])</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(grid.delr)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">grid.delc ="</span>, grid.delc[<span class="dv">0</span>])</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(grid.delc)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">grid.delz ="</span>, grid.delz[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(grid.delz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>15 [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]

grid.delr = 1.0
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 1 
 shape : (15,) 
 size(bytes) : 8 
 size(elements) : 15

grid.delc = 1.0
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 1 
 shape : (10,) 
 size(bytes) : 8 
 size(elements) : 10

grid.delz = 1.0
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 3 
 shape : (1, 10, 15) 
 size(bytes) : 8 
 size(elements) : 150</code></pre>
</div>
</div>
<div id="e2e724b7-121d-4442-b5d5-e2bc75190a55" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.top es un numpy.ndarray 2D de tamaño nrow x ncol</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.botm es un numpy.ndarray 3D de tamaño nlay x nrow x ncol</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"grid.top ="</span>, grid.top[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(grid.top)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">grid.botm ="</span>, grid.botm[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(grid.botm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>grid.top = 0.0
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 2 
 shape : (10, 15) 
 size(bytes) : 8 
 size(elements) : 150

grid.botm = -1.0
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 3 
 shape : (1, 10, 15) 
 size(bytes) : 8 
 size(elements) : 150</code></pre>
</div>
</div>
<div id="87282686-1840-4839-9e0e-af924ecffd9a" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dos maneras de calcular la longitud del dominio en las direcciones de los ejes son:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(1) Lx = "</span>, grid.extent[<span class="dv">1</span>] <span class="op">-</span> grid.extent[<span class="dv">0</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"    Ly = "</span>, grid.extent[<span class="dv">3</span>] <span class="op">-</span> grid.extent[<span class="dv">2</span>])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(2) Lx = "</span>, grid.ncol <span class="op">*</span> grid.delr[<span class="dv">0</span>])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"    Ly = "</span>, grid.nrow <span class="op">*</span> grid.delc[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1) Lx =  15.0
    Ly =  10.0
(2) Lx =  15.0
    Ly =  10.0</code></pre>
</div>
</div>
<div id="a80dbe8e-7fdc-485e-94da-0423272aec0e" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.xyzcellcenters es una lista que contiene un numpy.ndarray de nrow x ncol</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"grid.xyzcellcenters[0]"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(grid.xyzcellcenters[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>grid.xyzcellcenters[0]
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 2 
 shape : (10, 15) 
 size(bytes) : 8 
 size(elements) : 150</code></pre>
</div>
</div>
<p>Flopy contiene herramientas para visualización. Por ejemplo podemos crear un objeto de la clase <code>flopy.plot.PlotMapView</code> para graficar la malla:</p>
<div id="e68ae92f-f96e-4fd7-96e5-70457842d97d" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear objeto de vista en planta</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mapview <span class="op">=</span> flopy.plot.PlotMapView(model<span class="op">=</span>o_gwf)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dibujar la malla</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>mapview.plot_grid(linewidths<span class="op">=</span><span class="fl">0.75</span>, color<span class="op">=</span><span class="st">"silver"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Malla del modelo GWF"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X (m)"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y (m)"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="st">'equal'</span>)  <span class="co"># Para mantener proporciones</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_MF6_GWF_paq_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="paso-3.-condiciones-iniciales." class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="paso-3.-condiciones-iniciales."><span class="header-section-number">5.4</span> Paso 3. Condiciones iniciales.</h2>
<p>El paquete encargado de definir las condiciones iniciales es IC (<em>Initial Conditions</em>). Véase <strong>Initial Conditions (IC) Package</strong>, pp 43 en [2], para más información.</p>
<p>Se utiliza para asignar los valores iniciales de la carga hidráulica en todas las celdas activas del modelo al comenzar una simulación, especialmente importante cuando se trabaja con modelos transitorios.</p>
<p>Se aplica al inicio del primer periodo de estrés y es obligatorio en el modelo GWF.</p>
<p>En simulaciones estacionarias, los valores iniciales no afectan los resultados finales, pero aún así son requeridos por MODFLOW 6.</p>
<p>El modelo no podrá ejecutarse correctamente si no se proporciona este paquete.</p>
<div class="alert alert-block alert-info">
<p><strong>Parámetros a usar</strong>.</p>
<ul>
<li>Usaremos la clase <a href="https://flopy.readthedocs.io/en/latest/source/flopy.mf6.modflow.mfgwfic.html"><code>flopy.mf6.ModflowGwfic</code></a> para crear el objeto <code>o_ic</code>.</li>
<li>El primer parámetro es el modelo <code>o_gwf</code> al que se le desean agregar las condiciones iniciales.</li>
<li>El parámetro <code>strt</code> indica el valor de la condición inicial para la carga hidráulica. Puede ser un número escalar (mismo valor en todo el dominio) o un arreglo 2D o 3D para especificar la carga en cada celda.</li>
</ul>
<p>En la siguiente celda se genera una condición inicial de carga hidráulica igual a <span class="math inline">\(10\)</span>:</p>
</div>
<div id="8bb48aed-ba51-46c3-b73f-f6d058cf5740" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>o_ic <span class="op">=</span> flopy.mf6.ModflowGwfic(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> o_gwf,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    strt<span class="op">=</span><span class="fl">10.0</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(o_ic)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>o_sim.write_simulation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package_name = ic
filename = flow.ic
package_type = ic
model_or_simulation_package = model
model_name = flow

Block griddata
--------------------
strt
{constant 10.0}



writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model flow...
    writing model name file...
    writing package dis...
    writing package ic...</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Explicación</strong>.</p>
<ul>
<li>La celda anterior genera el archivo <code>flow.ic</code> con la información para las condiciones iniciales.</li>
<li>Adicionalmente se agrega la información de este paquete en el archivo <code>flow.nam</code>. Deberías obtener un bloque en ese archivo como el que sigue:</li>
</ul>
<pre><code>BEGIN packages
  DIS6  flow.dis  dis
  IC6  flow.ic  ic
END packages</code></pre>
<p><br></p>
<p><strong>TIP</strong>. Si se tiene un modelo con topografía variable y se desea usar la elevación superior como condición inicial, se podría hacer algo como:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>strt <span class="op">=</span> top.copy()  <span class="co"># usar la elevación como nivel inicial</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ic <span class="op">=</span> flopy.mf6.ModflowGwfic(gwf, strt<span class="op">=</span>strt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="paso-4.-condiciones-de-frontera." class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="paso-4.-condiciones-de-frontera."><span class="header-section-number">5.5</span> Paso 4. Condiciones de frontera.</h2>
<p>EL paquete CHD tienen un funcionamiento diferente al de los otros paquetes hidrológicos de MODFLOW 6; no adiciona cambios en el sistema de ecuaciones como lo hacen otros paquetes. Lo que hace CHD es simplemente asignar un código interno indicando que:</p>
<ol type="1">
<li>la carga varía con el tiempo (celda con carga variable),</li>
<li>la carga es constante (celda con carga constante),</li>
<li>no hay flujo hacia dentro o hacia afuera de la celda (celda inactiva).</li>
</ol>
<p>Este código es usado por la componente de solución numérica para determinar cómo debe manejar las ecuaciones.</p>
<p>El paquete CHD lee los datos del archivo con extensión <code>.chd</code> en donde se indica la lista de celdas con el valor correspondiente y lee la información al inicio de cada periodo de estrés, lo que hace posible cambiar el valor de la carga en dichas celdas durante la simulación.</p>
<p>Con este paquete se pueden imponer condiciones de frontera de tipo Dirichlet para la carga hidráulica.</p>
<p>Véase <strong>Constant-Head (CHD) Package</strong>, pp 76 en [2], para más información.</p>
<div class="alert alert-block alert-info">
<p><strong>Preparación de los datos</strong>.</p>
<ul>
<li>Para definir las condiciones <span class="math inline">\(h = 10\)</span> en <span class="math inline">\(x=0\)</span> y <span class="math inline">\(h = 5\)</span> en <span class="math inline">\(x=15\)</span>, primero crearemos una lista de índices y valores como sigue:</li>
</ul>
</div>
<div id="52a61d61-d5bf-4406-9c41-2abaed814291" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chd_data <span class="op">=</span> []</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(nrow):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    chd_data.append([(<span class="dv">0</span>, row, <span class="dv">0</span>), <span class="fl">10.0</span>])       <span class="co"># Condición en la pared izquierda</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    chd_data.append([(<span class="dv">0</span>, row, ncol <span class="op">-</span> <span class="dv">1</span>), <span class="fl">5.0</span>]) <span class="co"># Condición en la pared derecha</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisamos el resultado</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> chd_data:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[(0, 0, 0), 10.0]
[(0, 0, 14), 5.0]
[(0, 1, 0), 10.0]
[(0, 1, 14), 5.0]
[(0, 2, 0), 10.0]
[(0, 2, 14), 5.0]
[(0, 3, 0), 10.0]
[(0, 3, 14), 5.0]
[(0, 4, 0), 10.0]
[(0, 4, 14), 5.0]
[(0, 5, 0), 10.0]
[(0, 5, 14), 5.0]
[(0, 6, 0), 10.0]
[(0, 6, 14), 5.0]
[(0, 7, 0), 10.0]
[(0, 7, 14), 5.0]
[(0, 8, 0), 10.0]
[(0, 8, 14), 5.0]
[(0, 9, 0), 10.0]
[(0, 9, 14), 5.0]</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Parámetros a usar</strong>.</p>
<ul>
<li>Ahora creamos un objeto de la clase <a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.mf6.modflow.mfgwfchd.html"><code>flopy.mf6.ModflowGwfchd</code></a>.</li>
<li>El primer parámetro será el modelo <code>o_gwf</code> al que se le impondrán las condiciones iniciales.</li>
<li>En este ejemplo usamos el parámetro <code>stress_period_data</code> para definir las condiciones de frontera, que requiere una lista de la forma: <code>[cellid, head, aux, boundname]</code> donde:
<ul>
<li><code>cellid</code> es el identificador de la celda.
<ul>
<li>Para una malla de tipo DIS el CELLID está formado por tuplas (layer, row, column).</li>
<li>Se usan arreglos que inician en <span class="math inline">\(0\)</span>.</li>
<li>Flopy ajustará el valor de los índices para ejecutar MODFLOW 6 en donde los índices inician en <span class="math inline">\(1\)</span>.</li>
</ul></li>
<li><code>head</code> es el valor de la carga hidráulica en la frontera.</li>
<li>los valores <code>aux</code> y <code>boundname</code> son opcionales y no se usarán por ahora.</li>
</ul></li>
<li>La lista <code>chd_data</code> creada anteriormente se usará como argumento de <code>stress_period_data</code>, veamos como:</li>
</ul>
</div>
<div id="a0877460-cb65-40fe-8afa-27f5fecfc2d5" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>o_chd <span class="op">=</span> flopy.mf6.ModflowGwfchd(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> o_gwf,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    stress_period_data<span class="op">=</span>chd_data,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(o_chd)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>o_sim.write_simulation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package_name = chd_0
filename = flow.chd
package_type = chd
model_or_simulation_package = model
model_name = flow

Block period
--------------------
stress_period_data
{internal}
(    cellid_layer  cellid_row  cellid_column  head
0              0           0              0  10.0
1              0           0             14   5.0
2              0           1              0  10.0
3              0           1             14   5.0
4              0           2              0  10.0
5              0           2             14   5.0
6              0           3              0  10.0
7              0           3             14   5.0
8              0           4              0  10.0
9              0           4             14   5.0
10             0           5              0  10.0
11             0           5             14   5.0
12             0           6              0  10.0
13             0           6             14   5.0
14             0           7              0  10.0
15             0           7             14   5.0
16             0           8              0  10.0
17             0           8             14   5.0
18             0           9              0  10.0
19             0           9             14   5.0)



writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model flow...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package chd_0...
INFORMATION: maxbound in ('gwf6', 'chd', 'dimensions') changed to 20 based on size of stress_period_data</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Observación</strong>.</p>
<p>El resultado se escribirá en el archivo <code>flow.chd</code> que contendrá la lista de celdas con el valor correspondiente.</p>
</div>
</section>
<section id="paso-5.-propiedades-hidráulicas." class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="paso-5.-propiedades-hidráulicas."><span class="header-section-number">5.6</span> Paso 5. Propiedades hidráulicas.</h2>
<p>El paquete NPF (<em>Node Property Flow</em>) calcula la conductancia hidráulica, tanto vertical como horizontal, entre celdas adyancentes.</p>
<p>Este paquete calcula los coeficientes <span class="math inline">\(C_{n,m}\)</span> que aparecen en la siguiente forma de la ecuación CVFD:</p>
<p><span class="math display">\[
\sum_{m \in \eta_n} C_{n,m}(h_m - h_n) - P_n h_n + Q_n = SS_n A_n \Delta v_n \dfrac{h_n - HOLD_n}{t -t_{old}}
\]</span></p>
<p>NPF soporta celdas confinadas y convertibles. Para determinar el tipo de celda se usa el parámetro <em>ICELLTYPE</em>.</p>
<p>También, usando NPF se define la conductividad hidráulica <span class="math inline">\(k\)</span>.</p>
<p>Para más información véase [1] <strong>Chapter 4. Internal Flow Packages</strong>, pp 4-1, y <strong>Node Property Flow (NPF) Package</strong>, pp 49 en [2].</p>
<div class="alert alert-block alert-info">
<p><strong>Parámetros a usar</strong>.</p>
<ul>
<li>En este caso la conductividad hidráulica es constante <span class="math inline">\(k = 1.0\)</span>.</li>
<li>Usamos un objeto de la clase <a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.mf6.modflow.mfgwfnpf.html"><code>flopy.mf6.ModflowGwfnpf</code></a> para definir el valor de <span class="math inline">\(k\)</span>.</li>
<li>También agregamos el parámetro <code>save_specific_discharge = True</code> para almacenar la descarga específica <span class="math inline">\(q\)</span>.</li>
</ul>
</div>
<div id="68e5f485-32be-4ce6-9d7d-3efc840b0c8d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>o_npf <span class="op">=</span> flopy.mf6.ModflowGwfnpf(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> o_gwf,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    save_specific_discharge <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="fl">1.0</span>, <span class="co"># conductividad hidráulica (constante)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(o_npf)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>o_sim.write_simulation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package_name = npf
filename = flow.npf
package_type = npf
model_or_simulation_package = model
model_name = flow

Block options
--------------------
save_specific_discharge
{internal}
(True)


Block griddata
--------------------
icelltype
{constant 0}

k
{constant 1.0}



writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model flow...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package chd_0...
    writing package npf...</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Observación</strong>.</p>
<p>El código anterior genera el archivo <code>flow.npf</code> con el siguiente contenido:</p>
<pre><code># File generated by Flopy version 3.9.2 on 04/26/2025 at 11:32:43.
BEGIN options
  SAVE_SPECIFIC_DISCHARGE
END options

BEGIN griddata
  icelltype
    CONSTANT  0
  k
    CONSTANT       1.00000000
END griddata</code></pre>
</div>
</section>
<section id="paso-6.-configuración-de-la-salida." class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="paso-6.-configuración-de-la-salida."><span class="header-section-number">5.7</span> Paso 6. Configuración de la salida.</h2>
<p>EL paquete OC (<em>Output Control</em>) determina cómo y cuándo se imprimirá o almacenará la información de salida de la simulación carga hidráulica (head) y del <em>budget</em>.</p>
<p>Esta información se puede enviar a: * la pantalla de salida cuando se ejectua MODFLOW 6, * los archivos de listado <code>.lst</code>, * archivos en formato binario.</p>
<p>Para más información véase <strong>Output Control (OC) Option</strong>, pp 44 en [2].</p>
<div class="alert alert-block alert-info">
<p><strong>Parámetros a usar</strong>.</p>
<ul>
<li>Para configurar la salida usamos un objeto de la clase <a href="https://flopy.readthedocs.io/en/3.9.0/source/flopy.mf6.modflow.mfgwfoc.html"><code>flopy.mf6.ModflowGwfoc</code></a> indicando:
<ul>
<li>El modelo GWF,</li>
<li>los archivos para almacenar el <em>budget</em> (<code>flow.bud</code>) y la carga hidráulica (<code>flow.hds</code>),</li>
<li>la información que se almacenará en archivos binarios usando el parámetro <code>saverecord</code>,</li>
<li>la información que se enviará al archivo de listado (<code>flow.lst</code>) usando el parámetro <code>printrecord</code>.</li>
</ul></li>
</ul>
</div>
<div id="be0d417f-e954-4971-940e-f12ac39d79b6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>o_oc <span class="op">=</span> flopy.mf6.ModflowGwfoc(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> o_gwf,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    budget_filerecord <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>sim_name<span class="sc">}</span><span class="ss">.bud"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    head_filerecord <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>sim_name<span class="sc">}</span><span class="ss">.hds"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    saverecord <span class="op">=</span> [(<span class="st">"HEAD"</span>, <span class="st">"ALL"</span>), (<span class="st">"BUDGET"</span>, <span class="st">"ALL"</span>)],</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    printrecord <span class="op">=</span> [(<span class="st">"HEAD"</span>, <span class="st">"ALL"</span>)]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(o_oc)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>o_sim.write_simulation()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package_name = oc
filename = flow.oc
package_type = oc
model_or_simulation_package = model
model_name = flow

Block options
--------------------
budget_filerecord
{internal}
([('flow.bud',)])

head_filerecord
{internal}
([('flow.hds',)])


Block period
--------------------
saverecord
{internal}
([('HEAD', 'ALL', None) ('BUDGET', 'ALL', None)])

printrecord
{internal}
([('HEAD', 'ALL', None)])



writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model flow...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package chd_0...
    writing package npf...
    writing package oc...</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Observación</strong>.</p>
<p>La celda anterior genera el archivo <code>flow.oc</code> con los datos para la salida como sigue:</p>
<pre><code># File generated by Flopy version 3.9.2 on 04/26/2025 at 11:36:03.
BEGIN options
  BUDGET  FILEOUT  flow.bud
  HEAD  FILEOUT  flow.hds
END options

BEGIN period  1
  SAVE  HEAD  ALL
  SAVE  BUDGET  ALL
  PRINT  HEAD  ALL
END period  1</code></pre>
</div>
</section>
<section id="paso-7.-ejecución-de-la-simulación." class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="paso-7.-ejecución-de-la-simulación."><span class="header-section-number">5.8</span> Paso 7. Ejecución de la simulación.</h2>
<p>En este punto tenemos con toda la información de entrada en los siguientes archivos:</p>
<ul>
<li><code>flow.tdis</code>: datos para la discretización temporal.</li>
<li><code>flow.ims</code>: datos para la solución numérica.</li>
<li><code>flow.dis</code>: datos para la discretización espacial.</li>
<li><code>flow.ic</code>: datos para las condiciones iniciales.</li>
<li><code>flow.chd</code>: datos para las condiciones de frontera.</li>
<li><code>flow.npf</code>: datos para los flujos entre celdas.</li>
<li><code>flow.oc</code>: datos para la salida de los resultados.</li>
<li><code>flow.nam</code>: datos para el modelo GWF, informa de los paquetes que se usan.</li>
<li><code>mfsim.nam</code>: datos de la simulación completa, informa de las componentes que se usan.</li>
</ul>
<p>Podemos ejecutar la simulación como sigue:</p>
<div id="026e56c4-bbe9-472c-a628-346d663a489c" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>o_sim.run_simulation(silent<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FloPy is using the following executable to run the model: ..\..\..\..\mf6\windows\mf6.exe
                                   MODFLOW 6
                U.S. GEOLOGICAL SURVEY MODULAR HYDROLOGIC MODEL
                            VERSION 6.6.1 02/10/2025

   MODFLOW 6 compiled Feb 10 2025 17:37:25 with Intel(R) Fortran Intel(R) 64
   Compiler Classic for applications running on Intel(R) 64, Version 2021.7.0
                             Build 20220726_000000

This software has been approved for release by the U.S. Geological 
Survey (USGS). Although the software has been subjected to rigorous 
review, the USGS reserves the right to update the software as needed 
pursuant to further analysis and review. No warranty, expressed or 
implied, is made by the USGS or the U.S. Government as to the 
functionality of the software and related material nor shall the 
fact of release constitute any such warranty. Furthermore, the 
software is released on condition that neither the USGS nor the U.S. 
Government shall be held liable for any damages resulting from its 
authorized or unauthorized use. Also refer to the USGS Water 
Resources Software User Rights Notice for complete use, copyright, 
and distribution information.

 
 MODFLOW runs in SEQUENTIAL mode
 
 Run start date and time (yyyy/mm/dd hh:mm:ss): 2025/05/18 13:17:59
 
 Writing simulation list file: mfsim.lst
 Using Simulation name file: mfsim.nam
 
    Solving:  Stress period:     1    Time step:     1
 
 Run end date and time (yyyy/mm/dd hh:mm:ss): 2025/05/18 13:17:59
 Elapsed run time:  0.202 Seconds
 
 Normal termination of simulation.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(True, [])</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Observaciones</strong>.</p>
<p>La ejecución de la simulación genera los siguientes archivos:</p>
<ul>
<li><code>flow.dis.grb</code>: información de la malla con todos los datos de las coordenadas, conectividad y otros (binario).</li>
<li><code>flow.bud</code>: datos del <em>budget</em> (binario).</li>
<li><code>flow.hds</code>: datos de la carga hidráulica (binario).</li>
<li><code>flow.lst</code>: archivo de listado con información de los resultados del modelo GWF.</li>
<li><code>mfsim.lst</code>: archivo de listado con información general de la simulación.</li>
</ul>
</div>
</section>
<section id="paso-8.-recuperación-y-visualización-de-los-resultados." class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="paso-8.-recuperación-y-visualización-de-los-resultados."><span class="header-section-number">5.9</span> Paso 8. Recuperación y visualización de los resultados.</h2>
<section id="recuperación-de-la-carga-hidráulica." class="level3" data-number="5.9.1">
<h3 data-number="5.9.1" class="anchored" data-anchor-id="recuperación-de-la-carga-hidráulica."><span class="header-section-number">5.9.1</span> Recuperación de la carga hidráulica.</h3>
<p>Para analizar los resultados generados por la simulación almacenados en los archivos descritos antes usaremos las herramientas que ofrece Flopy.</p>
<div class="alert alert-block alert-info">
<p><strong>Objetos, funciones y archivos a usar</strong>.</p>
<ul>
<li>Primero recuperamos la carga hidráulica almacenada en el archivo <code>flow.hds</code> usando un objeto de la clase <a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.utils.binaryfile.html#flopy.utils.binaryfile.HeadFile"><code>flopy.utils.HeadFile</code></a>.</li>
<li>Posteriormente, con la función <code>get_data</code> obtenemos un arreglo de numpy con la información correspondiente:</li>
</ul>
</div>
<div id="fe98247d-9ec4-4fd1-8d28-aa20b76e84fb" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construimos el nombre con la ruta y extensión correcta</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>headfile <span class="op">=</span> os.path.join(<span class="ss">f"</span><span class="sc">{</span>sim_ws<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"</span><span class="sc">{</span>sim_name<span class="sc">}</span><span class="ss">.hds"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Objeto para obtener y manipular arreglos o series de tiempo de arreglos con datos</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># de una o más celdas con información del archivo binario de la carga hidráulica.</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>hds <span class="op">=</span> flopy.utils.HeadFile(headfile)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Solo se obtiene la capa 0, cuando no se pone ningún valor en el parámetro mlay se obtienen todas las capas</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>head <span class="op">=</span> hds.get_data(mflay<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimimos la información</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"head array"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(head)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">HEAD:</span><span class="ch">\n</span><span class="st">"</span>, head)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>head array
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 2 
 shape : (10, 15) 
 size(bytes) : 8 
 size(elements) : 150

HEAD:
 [[10.          9.64285714  9.28571428  8.92857142  8.57142856  8.21428571
   7.85714285  7.5         7.14285714  6.78571427  6.42857141  6.07142855
   5.71428569  5.35714284  5.        ]
 [10.          9.64285714  9.28571428  8.92857142  8.57142856  8.2142857
   7.85714286  7.50000001  7.14285715  6.78571428  6.42857141  6.07142855
   5.71428569  5.35714285  5.        ]
 [10.          9.64285714  9.28571428  8.92857143  8.57142857  8.21428571
   7.85714285  7.5         7.14285715  6.78571428  6.42857142  6.07142856
   5.71428571  5.35714286  5.        ]
 [10.          9.64285714  9.28571429  8.92857143  8.57142858  8.21428572
   7.85714286  7.5         7.14285715  6.78571429  6.42857143  6.07142858
   5.71428572  5.35714286  5.        ]
 [10.          9.64285715  9.28571429  8.92857143  8.57142858  8.21428572
   7.85714287  7.5         7.14285715  6.7857143   6.42857145  6.07142859
   5.71428573  5.35714287  5.        ]
 [10.          9.64285715  9.28571429  8.92857144  8.57142858  8.21428572
   7.85714287  7.50000001  7.14285715  6.7857143   6.42857145  6.07142859
   5.71428573  5.35714287  5.        ]
 [10.          9.64285715  9.28571429  8.92857143  8.57142857  8.21428571
   7.85714286  7.50000001  7.14285715  6.78571429  6.42857144  6.07142859
   5.71428572  5.35714286  5.        ]
 [10.          9.64285714  9.28571429  8.92857143  8.57142857  8.21428571
   7.85714285  7.5         7.14285714  6.78571428  6.42857142  6.07142858
   5.71428572  5.35714285  5.        ]
 [10.          9.64285714  9.28571428  8.92857142  8.57142857  8.21428571
   7.85714284  7.49999998  7.14285712  6.78571427  6.42857141  6.07142856
   5.71428572  5.35714286  5.        ]
 [10.          9.64285714  9.28571428  8.92857142  8.57142857  8.21428571
   7.85714284  7.49999998  7.14285712  6.78571426  6.42857141  6.07142855
   5.7142857   5.35714285  5.        ]]</code></pre>
</div>
</div>
</section>
<section id="visualización-de-la-carga-hidráulica." class="level3" data-number="5.9.2">
<h3 data-number="5.9.2" class="anchored" data-anchor-id="visualización-de-la-carga-hidráulica."><span class="header-section-number">5.9.2</span> Visualización de la carga hidráulica.</h3>
<p>Flopy también contiene herramientas para visualizar los resultados. Se combina con la biblioteca <code>matplotlib</code> para generar gráficas XY, mapas de color, contornos, vectores, entre otros.</p>
<div class="alert alert-block alert-info">
<p><strong>Objetos y funciones a usar</strong>.</p>
<ul>
<li>Para visualizar estos resultados usamos un objeto de la clase <a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.plot.map.html#flopy.plot.map.PlotMapView"><code>flopy.plot.PlotMapView</code></a> con la cual se crea un mapa del modelo y delega la funcionalidad de la graficación de acuerdo con el tipo de malla del modelo.</li>
<li>Agregamos a esta visualización lo siguiente:
<ul>
<li><a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.plot.map.html#flopy.plot.map.PlotMapView.plot_array"><code>plot_array()</code></a> : genera un mapa de color con los datos de la carga cidráulica.</li>
<li><a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.plot.map.html#flopy.plot.map.PlotMapView.contour_array"><code>contour_array()</code></a> : genera contornos con los datos de la carga cidráulica.</li>
<li><a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.plot.map.html#flopy.plot.map.PlotMapView.plot_grid"><code>plot_grid</code></a> : dibuja la malla del modelo.</li>
</ul></li>
<li>Usamos también la función <code>xmf6.cax()</code> para obtener un espacio adecuado para la barra de color.</li>
</ul>
</div>
<div id="e54ee700-0762-4762-ab50-cb9ec5cddba7" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.gca() <span class="co"># Ejes donde se hará la graficación</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapa visual del modelo. En este caso el modelo es 'o_gwf'.</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>mapview <span class="op">=</span> flopy.plot.PlotMapView(model<span class="op">=</span>o_gwf, ax<span class="op">=</span>ax)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la carga hidráulica usando un mapa de color.</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>cb <span class="op">=</span> mapview.plot_array(head, cmap<span class="op">=</span><span class="st">"viridis"</span>, vmin<span class="op">=</span>np.nanmin(head), vmax<span class="op">=</span>np.nanmax(head))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la carga hidráulica usando contornos.</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> mapview.contour_array(head, levels<span class="op">=</span><span class="dv">20</span>, linewidths<span class="op">=</span><span class="fl">1.0</span>, colors<span class="op">=</span><span class="st">'silver'</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la malla, con una transparencia.</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>mapview.plot_grid(linewidths<span class="op">=</span><span class="fl">0.5</span>, alpha <span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Barra de color.</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>plt.colorbar(cb, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"h (m)"</span>, cax <span class="op">=</span> xmf6.vis.cax(ax, cb))</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalización de la gráfica.</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Carga hidráulica (capa 1)"</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"X (m)"</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Y (m)"</span>)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_MF6_GWF_paq_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="recuperación-de-la-descarga-específica." class="level3" data-number="5.9.3">
<h3 data-number="5.9.3" class="anchored" data-anchor-id="recuperación-de-la-descarga-específica."><span class="header-section-number">5.9.3</span> Recuperación de la descarga específica.</h3>
<p>También es posible calcular y graficar la descarga específica, la cual se define como</p>
<p><span class="math display">\[
q = -K \nabla h
\]</span></p>
<p>Donde: * <span class="math inline">\(q\)</span> : vector de descarga específica (flujo Darciano) [L/T]. * <span class="math inline">\(K\)</span> : conductividad hidráulica del medio [L/T]. * <span class="math inline">\(\nabla h\)</span>: gradiente hidráulico (variación espacial de la carga hidráulica).</p>
<div class="alert alert-block alert-info">
<p><strong>Objetos, funciones y archivos a usar</strong>.</p>
<ul>
<li>En este caso usaremos un objeto de la clase <a href="https://flopy.readthedocs.io/en/3.3.2/source/flopy.utils.binaryfile.html#flopy.utils.binaryfile.CellBudgetFile"><code>flopy.utils.CellBudgetFile</code></a>.</li>
<li>Luego para obtener los datos usamos la función <code>get_data()</code>. En este caso se requiere del parámetro <code>text = "DATA-SPDIS"</code> que indica que se obtendrá la descarga específica.</li>
<li>Para que esto funcione, es necesario agregar el parámetro <code>save_specific_discharge = True</code> en el paquete NPF (<em>Node Property Flow</em>).</li>
<li>La función <code>get_data</code> regresará una lista que contiene un solo elemento, el cual es un arreglo de tipo <a href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html"><code>numpy.rec.recarray</code></a>.</li>
</ul>
</div>
<div id="2549a827-7c5c-42e1-b969-95eae120e75b" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construimos el nombre con la ruta y extensión correcta</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>budfile <span class="op">=</span> os.path.join(<span class="ss">f"</span><span class="sc">{</span>sim_ws<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"</span><span class="sc">{</span>sim_name<span class="sc">}</span><span class="ss">.bud"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Objeto para obtener y manipular arreglos o series de tiempo de arreglos con datos</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># de una o más celdas con información del archivo binario del budget.</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>bud  <span class="op">=</span> flopy.utils.CellBudgetFile(budfile)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar resultados de la descarga específica</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>spdis <span class="op">=</span> bud.get_data(text<span class="op">=</span><span class="st">"DATA-SPDIS"</span>)[<span class="dv">0</span>]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimimos la información</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"spdis array:"</span>, spdis.shape)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spdis array: (150,)
 tipo  : &lt;class 'numpy.rec.recarray'&gt; 
 dtype : (numpy.record, [('node', '&lt;i4'), ('node2', '&lt;i4'), ('q', '&lt;f8'), ('qx', '&lt;f8'), ('qy', '&lt;f8'), ('qz', '&lt;f8')]) 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 40 
 size(elements) : 150</code></pre>
</div>
</div>
<div class="alert alert-block alert-info">
<p><strong>Observaciones</strong>.</p>
<ul>
<li>El objeto <code>spdis</code> es de tipo <code>numpy.rec.recarray</code> con 6 columnas de información: <code>node</code>, <code>node2</code>, <code>q</code>, <code>qx</code>, <code>qy</code>, <code>qz</code>.</li>
<li>Cada renglón de este arreglo corresponde a la información de una celda (en este caso <span class="math inline">\(15 \times 10 =  150\)</span> celdas).</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 72%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Columna</th>
<th>Descripción</th>
<th>Unidades</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>node</code></td>
<td>Índice del nodo origen: celda desde la que sale el flujo</td>
<td>—</td>
</tr>
<tr class="even">
<td><code>node2</code></td>
<td>Índice del nodo destino: celda hacia la que va el flujo</td>
<td>—</td>
</tr>
<tr class="odd">
<td><code>q</code></td>
<td>Caudal total entre <code>node</code> y <code>node2</code></td>
<td>m³/d</td>
</tr>
<tr class="even">
<td><code>qx</code></td>
<td>Componente del flujo en dirección <span class="math inline">\(x\)</span></td>
<td>m³/d</td>
</tr>
<tr class="odd">
<td><code>qy</code></td>
<td>Componente del flujo en dirección <span class="math inline">\(y\)</span></td>
<td>m³/d</td>
</tr>
<tr class="even">
<td><code>qz</code></td>
<td>Componente del flujo en dirección <span class="math inline">\(z\)</span> (positivo hacia abajo)</td>
<td>m³/d</td>
</tr>
</tbody>
</table>
<ul>
<li>Podemos ver el contenido de este arreglo como sigue:</li>
</ul>
</div>
<div id="85fb3904-43e8-4fe1-b46a-372cec6c1988" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">SPDIS:</span><span class="ch">\n</span><span class="st">"</span>, spdis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SPDIS:
 [(  1,   1, 0., 0.35714286,  0.00000000e+00, 0.)
 (  2,   2, 0., 0.35714286,  5.47633050e-10, 0.)
 (  3,   3, 0., 0.35714286,  7.50866036e-12, 0.)
 (  4,   4, 0., 0.35714286, -1.00981623e-09, 0.)
 (  5,   5, 0., 0.35714286, -1.53560009e-09, 0.)
 (  6,   6, 0., 0.35714285, -8.93553675e-10, 0.)
 (  7,   7, 0., 0.35714285,  2.87018409e-09, 0.)
 (  8,   8, 0., 0.35714286,  1.05430837e-08, 0.)
 (  9,   9, 0., 0.35714286,  1.47557371e-08, 0.)
 ( 10,  10, 0., 0.35714286,  8.12601186e-09, 0.)
 ( 11,  11, 0., 0.35714286,  4.20858903e-10, 0.)
 ( 12,  12, 0., 0.35714286,  1.66894321e-09, 0.)
 ( 13,  13, 0., 0.35714285,  4.89590590e-09, 0.)
 ( 14,  14, 0., 0.35714284,  5.71419445e-09, 0.)
 ( 15,  15, 0., 0.35714284,  0.00000000e+00, 0.)
 ( 16,  16, 0., 0.35714286,  0.00000000e+00, 0.)
 ( 17,  17, 0., 0.35714286,  5.43539436e-10, 0.)
 ( 18,  18, 0., 0.35714286,  8.54491589e-10, 0.)
 ( 19,  19, 0., 0.35714286,  2.06802397e-09, 0.)
 ( 20,  20, 0., 0.35714286,  3.72881459e-09, 0.)
 ( 21,  21, 0., 0.35714285,  3.38642092e-09, 0.)
 ( 22,  22, 0., 0.35714285,  1.03656950e-09, 0.)
 ( 23,  23, 0., 0.35714285,  1.75400272e-09, 0.)
 ( 24,  24, 0., 0.35714286,  6.03943651e-09, 0.)
 ( 25,  25, 0., 0.35714287,  6.14190743e-09, 0.)
 ( 26,  26, 0., 0.35714286,  3.57975916e-09, 0.)
 ( 27,  27, 0., 0.35714286,  6.56130039e-09, 0.)
 ( 28,  28, 0., 0.35714285,  9.53989865e-09, 0.)
 ( 29,  29, 0., 0.35714285,  7.52138662e-09, 0.)
 ( 30,  30, 0., 0.35714285,  0.00000000e+00, 0.)
 ( 31,  31, 0., 0.35714286,  0.00000000e+00, 0.)
 ( 32,  32, 0., 0.35714286,  6.91943391e-10, 0.)
 ( 33,  33, 0., 0.35714286,  1.86103044e-09, 0.)
 ( 34,  34, 0., 0.35714286,  4.83698237e-09, 0.)
 ( 35,  35, 0., 0.35714286,  8.76451445e-09, 0.)
 ( 36,  36, 0., 0.35714286,  9.74681047e-09, 0.)
 ( 37,  37, 0., 0.35714286,  4.02223854e-09, 0.)
 ( 38,  38, 0., 0.35714285, -3.16989590e-09, 0.)
 ( 39,  39, 0., 0.35714286, -1.20540644e-09, 0.)
 ( 40,  40, 0., 0.35714286,  6.99057878e-09, 0.)
 ( 41,  41, 0., 0.35714286,  1.08003615e-08, 0.)
 ( 42,  42, 0., 0.35714286,  1.34577243e-08, 0.)
 ( 43,  43, 0., 0.35714285,  1.34282678e-08, 0.)
 ( 44,  44, 0., 0.35714285,  8.25992919e-09, 0.)
 ( 45,  45, 0., 0.35714286,  0.00000000e+00, 0.)
 ( 46,  46, 0., 0.35714286,  0.00000000e+00, 0.)
 ( 47,  47, 0., 0.35714286,  1.39541267e-09, 0.)
 ( 48,  48, 0., 0.35714286,  2.75352452e-09, 0.)
 ( 49,  49, 0., 0.35714285,  3.49437812e-09, 0.)
 ( 50,  50, 0., 0.35714285,  3.80157950e-09, 0.)
 ( 51,  51, 0., 0.35714286,  5.19847188e-09, 0.)
 ( 52,  52, 0., 0.35714286,  5.56624391e-09, 0.)
 ( 53,  53, 0., 0.35714286,  1.45992685e-09, 0.)
 ( 54,  54, 0., 0.35714285,  5.92713878e-10, 0.)
 ( 55,  55, 0., 0.35714286,  8.73039330e-09, 0.)
 ( 56,  56, 0., 0.35714286,  1.47507939e-08, 0.)
 ( 57,  57, 0., 0.35714286,  1.49993009e-08, 0.)
 ( 58,  58, 0., 0.35714286,  1.11664762e-08, 0.)
 ( 59,  59, 0., 0.35714286,  5.95146332e-09, 0.)
 ( 60,  60, 0., 0.35714286,  0.00000000e+00, 0.)
 ( 61,  61, 0., 0.35714285,  0.00000000e+00, 0.)
 ( 62,  62, 0., 0.35714285,  1.48180401e-09, 0.)
 ( 63,  63, 0., 0.35714286,  2.84630985e-09, 0.)
 ( 64,  64, 0., 0.35714286,  2.11817763e-09, 0.)
 ( 65,  65, 0., 0.35714286, -1.27107391e-09, 0.)
 ( 66,  66, 0., 0.35714286, -2.88448909e-09, 0.)
 ( 67,  67, 0., 0.35714286,  1.54385305e-09, 0.)
 ( 68,  68, 0., 0.35714286,  4.45305082e-09, 0.)
 ( 69,  69, 0., 0.35714285,  2.14465024e-09, 0.)
 ( 70,  70, 0., 0.35714285,  3.12278559e-09, 0.)
 ( 71,  71, 0., 0.35714285,  7.03745329e-09, 0.)
 ( 72,  72, 0., 0.35714286,  7.94326427e-09, 0.)
 ( 73,  73, 0., 0.35714286,  4.83928586e-09, 0.)
 ( 74,  74, 0., 0.35714287,  2.62405475e-09, 0.)
 ( 75,  75, 0., 0.35714287,  0.00000000e+00, 0.)
 ( 76,  76, 0., 0.35714285,  0.00000000e+00, 0.)
 ( 77,  77, 0., 0.35714285, -1.52249768e-10, 0.)
 ( 78,  78, 0., 0.35714286, -4.79487561e-10, 0.)
 ( 79,  79, 0., 0.35714286, -1.24683552e-09, 0.)
 ( 80,  80, 0., 0.35714286, -2.99411163e-09, 0.)
 ( 81,  81, 0., 0.35714285, -5.73222803e-09, 0.)
 ( 82,  82, 0., 0.35714285, -3.64090491e-09, 0.)
 ( 83,  83, 0., 0.35714286,  1.97418881e-09, 0.)
 ( 84,  84, 0., 0.35714286,  2.17832863e-10, 0.)
 ( 85,  85, 0., 0.35714285, -4.28550528e-09, 0.)
 ( 86,  86, 0., 0.35714285, -4.40030812e-09, 0.)
 ( 87,  87, 0., 0.35714286, -1.86558724e-09, 0.)
 ( 88,  88, 0., 0.35714286, -4.82911977e-09, 0.)
 ( 89,  89, 0., 0.35714287, -4.75692685e-09, 0.)
 ( 90,  90, 0., 0.35714287,  0.00000000e+00, 0.)
 ( 91,  91, 0., 0.35714285,  0.00000000e+00, 0.)
 ( 92,  92, 0., 0.35714286, -1.60843427e-09, 0.)
 ( 93,  93, 0., 0.35714286, -2.96047187e-09, 0.)
 ( 94,  94, 0., 0.35714286, -2.56772736e-09, 0.)
 ( 95,  95, 0., 0.35714286, -5.72208059e-10, 0.)
 ( 96,  96, 0., 0.35714286, -3.13721937e-09, 0.)
 ( 97,  97, 0., 0.35714285, -9.26611987e-09, 0.)
 ( 98,  98, 0., 0.35714285, -7.99172506e-09, 0.)
 ( 99,  99, 0., 0.35714286, -6.16383966e-09, 0.)
 (100, 100, 0., 0.35714286, -8.32303249e-09, 0.)
 (101, 101, 0., 0.35714285, -1.31341396e-08, 0.)
 (102, 102, 0., 0.35714286, -9.14399534e-09, 0.)
 (103, 103, 0., 0.35714287, -5.49348167e-09, 0.)
 (104, 104, 0., 0.35714286, -7.28141591e-09, 0.)
 (105, 105, 0., 0.35714286,  0.00000000e+00, 0.)
 (106, 106, 0., 0.35714286,  0.00000000e+00, 0.)
 (107, 107, 0., 0.35714286, -2.46356535e-09, 0.)
 (108, 108, 0., 0.35714286, -3.95433553e-09, 0.)
 (109, 109, 0., 0.35714286, -3.08912806e-09, 0.)
 (110, 110, 0., 0.35714286,  1.89291249e-10, 0.)
 (111, 111, 0., 0.35714286,  7.32352845e-10, 0.)
 (112, 112, 0., 0.35714286, -7.39661310e-09, 0.)
 (113, 113, 0., 0.35714285, -1.37140770e-08, 0.)
 (114, 114, 0., 0.35714286, -1.39238296e-08, 0.)
 (115, 115, 0., 0.35714286, -9.43181933e-09, 0.)
 (116, 116, 0., 0.35714285, -1.25264670e-08, 0.)
 (117, 117, 0., 0.35714285, -1.39834171e-08, 0.)
 (118, 118, 0., 0.35714286, -3.06157011e-09, 0.)
 (119, 119, 0., 0.35714286, -4.16186641e-10, 0.)
 (120, 120, 0., 0.35714285,  0.00000000e+00, 0.)
 (121, 121, 0., 0.35714286,  0.00000000e+00, 0.)
 (122, 122, 0., 0.35714286, -9.88087834e-10, 0.)
 (123, 123, 0., 0.35714286, -1.73246573e-09, 0.)
 (124, 124, 0., 0.35714285, -3.12913340e-09, 0.)
 (125, 125, 0., 0.35714286, -4.17634727e-09, 0.)
 (126, 126, 0., 0.35714286, -2.74673351e-09, 0.)
 (127, 127, 0., 0.35714287, -3.69824837e-09, 0.)
 (128, 128, 0., 0.35714286, -7.74172815e-09, 0.)
 (129, 129, 0., 0.35714285, -1.20199997e-08, 0.)
 (130, 130, 0., 0.35714285, -1.00885398e-08, 0.)
 (131, 131, 0., 0.35714286, -6.53736354e-09, 0.)
 (132, 132, 0., 0.35714285, -1.19671197e-08, 0.)
 (133, 133, 0., 0.35714285, -8.38436565e-09, 0.)
 (134, 134, 0., 0.35714286, -6.92109925e-10, 0.)
 (135, 135, 0., 0.35714286,  0.00000000e+00, 0.)
 (136, 136, 0., 0.35714286,  0.00000000e+00, 0.)
 (137, 137, 0., 0.35714286,  1.05580966e-09, 0.)
 (138, 138, 0., 0.35714286,  1.68792802e-09, 0.)
 (139, 139, 0., 0.35714286, -9.46094758e-10, 0.)
 (140, 140, 0., 0.35714286, -5.49697710e-09, 0.)
 (141, 141, 0., 0.35714286, -6.10685191e-09, 0.)
 (142, 142, 0., 0.35714286, -3.05696002e-09, 0.)
 (143, 143, 0., 0.35714286, -1.30559563e-09, 0.)
 (144, 144, 0., 0.35714286, -5.58576119e-09, 0.)
 (145, 145, 0., 0.35714285, -1.07803562e-08, 0.)
 (146, 146, 0., 0.35714286, -6.05407369e-09, 0.)
 (147, 147, 0., 0.35714285, -9.17450382e-09, 0.)
 (148, 148, 0., 0.35714285, -1.19560513e-08, 0.)
 (149, 149, 0., 0.35714285, -5.06436226e-09, 0.)
 (150, 150, 0., 0.35714285,  0.00000000e+00, 0.)]</code></pre>
</div>
</div>
<p>Podemos checar cada una de las columnas por separado:</p>
<div id="6bf59be2-277e-46e2-9152-a2be9e5c19c0" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">node:"</span>, spdis.node.shape)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis.node)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spdis.node)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">node2:"</span>, spdis.node2.shape)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis.node2)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spdis.node2)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">q:"</span>, spdis.q.shape)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis.q)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spdis.q)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">qx:"</span>, spdis.qx.shape)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis.qx)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spdis.qx)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">qy:"</span>, spdis.qy.shape)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis.qy)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spdis.qy)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">qz:"</span>, spdis.qz.shape)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(spdis.qz)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spdis.qz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
node: (150,)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : int32 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 4 
 size(elements) : 150
[  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108
 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126
 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144
 145 146 147 148 149 150]

node2: (150,)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : int32 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 4 
 size(elements) : 150
[  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108
 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126
 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144
 145 146 147 148 149 150]

q: (150,)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 8 
 size(elements) : 150
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0.]

qx: (150,)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 8 
 size(elements) : 150
[0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714285
 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714285 0.35714284 0.35714284 0.35714286 0.35714286 0.35714286
 0.35714286 0.35714286 0.35714285 0.35714285 0.35714285 0.35714286
 0.35714287 0.35714286 0.35714286 0.35714285 0.35714285 0.35714285
 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714286 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714285 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714285 0.35714285 0.35714286 0.35714286 0.35714286 0.35714285
 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714285 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714286 0.35714286 0.35714285 0.35714285 0.35714285 0.35714286
 0.35714286 0.35714287 0.35714287 0.35714285 0.35714285 0.35714286
 0.35714286 0.35714286 0.35714285 0.35714285 0.35714286 0.35714286
 0.35714285 0.35714285 0.35714286 0.35714286 0.35714287 0.35714287
 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714285 0.35714285 0.35714286 0.35714286 0.35714285 0.35714286
 0.35714287 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714286 0.35714286 0.35714286 0.35714286 0.35714285 0.35714286
 0.35714286 0.35714285 0.35714285 0.35714286 0.35714286 0.35714285
 0.35714286 0.35714286 0.35714286 0.35714285 0.35714286 0.35714286
 0.35714287 0.35714286 0.35714285 0.35714285 0.35714286 0.35714285
 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
 0.35714285 0.35714286 0.35714285 0.35714285 0.35714285 0.35714285]

qy: (150,)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 8 
 size(elements) : 150
[ 0.00000000e+00  5.47633050e-10  7.50866036e-12 -1.00981623e-09
 -1.53560009e-09 -8.93553675e-10  2.87018409e-09  1.05430837e-08
  1.47557371e-08  8.12601186e-09  4.20858903e-10  1.66894321e-09
  4.89590590e-09  5.71419445e-09  0.00000000e+00  0.00000000e+00
  5.43539436e-10  8.54491589e-10  2.06802397e-09  3.72881459e-09
  3.38642092e-09  1.03656950e-09  1.75400272e-09  6.03943651e-09
  6.14190743e-09  3.57975916e-09  6.56130039e-09  9.53989865e-09
  7.52138662e-09  0.00000000e+00  0.00000000e+00  6.91943391e-10
  1.86103044e-09  4.83698237e-09  8.76451445e-09  9.74681047e-09
  4.02223854e-09 -3.16989590e-09 -1.20540644e-09  6.99057878e-09
  1.08003615e-08  1.34577243e-08  1.34282678e-08  8.25992919e-09
  0.00000000e+00  0.00000000e+00  1.39541267e-09  2.75352452e-09
  3.49437812e-09  3.80157950e-09  5.19847188e-09  5.56624391e-09
  1.45992685e-09  5.92713878e-10  8.73039330e-09  1.47507939e-08
  1.49993009e-08  1.11664762e-08  5.95146332e-09  0.00000000e+00
  0.00000000e+00  1.48180401e-09  2.84630985e-09  2.11817763e-09
 -1.27107391e-09 -2.88448909e-09  1.54385305e-09  4.45305082e-09
  2.14465024e-09  3.12278559e-09  7.03745329e-09  7.94326427e-09
  4.83928586e-09  2.62405475e-09  0.00000000e+00  0.00000000e+00
 -1.52249768e-10 -4.79487561e-10 -1.24683552e-09 -2.99411163e-09
 -5.73222803e-09 -3.64090491e-09  1.97418881e-09  2.17832863e-10
 -4.28550528e-09 -4.40030812e-09 -1.86558724e-09 -4.82911977e-09
 -4.75692685e-09  0.00000000e+00  0.00000000e+00 -1.60843427e-09
 -2.96047187e-09 -2.56772736e-09 -5.72208059e-10 -3.13721937e-09
 -9.26611987e-09 -7.99172506e-09 -6.16383966e-09 -8.32303249e-09
 -1.31341396e-08 -9.14399534e-09 -5.49348167e-09 -7.28141591e-09
  0.00000000e+00  0.00000000e+00 -2.46356535e-09 -3.95433553e-09
 -3.08912806e-09  1.89291249e-10  7.32352845e-10 -7.39661310e-09
 -1.37140770e-08 -1.39238296e-08 -9.43181933e-09 -1.25264670e-08
 -1.39834171e-08 -3.06157011e-09 -4.16186641e-10  0.00000000e+00
  0.00000000e+00 -9.88087834e-10 -1.73246573e-09 -3.12913340e-09
 -4.17634727e-09 -2.74673351e-09 -3.69824837e-09 -7.74172815e-09
 -1.20199997e-08 -1.00885398e-08 -6.53736354e-09 -1.19671197e-08
 -8.38436565e-09 -6.92109925e-10  0.00000000e+00  0.00000000e+00
  1.05580966e-09  1.68792802e-09 -9.46094758e-10 -5.49697710e-09
 -6.10685191e-09 -3.05696002e-09 -1.30559563e-09 -5.58576119e-09
 -1.07803562e-08 -6.05407369e-09 -9.17450382e-09 -1.19560513e-08
 -5.06436226e-09  0.00000000e+00]

qz: (150,)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 1 
 shape : (150,) 
 size(bytes) : 8 
 size(elements) : 150
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0.]</code></pre>
</div>
</div>
<div id="77b0b0fb-545c-439e-8f13-4c67c1abe85e" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraemos las componentes del flujo en un arreglo 3D para graficación</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>qx, qy, qz <span class="op">=</span> flopy.utils.postprocessing.get_specific_discharge(spdis, o_gwf)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">qx:"</span>, qx.shape)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(qx)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(qx)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">qy:"</span>, qy.shape)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(qy)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(qy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
qx: (1, 10, 15)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 3 
 shape : (1, 10, 15) 
 size(bytes) : 8 
 size(elements) : 150
[[[0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714285
   0.35714285 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714285 0.35714284 0.35714284]
  [0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714285
   0.35714285 0.35714285 0.35714286 0.35714287 0.35714286 0.35714286
   0.35714285 0.35714285 0.35714285]
  [0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714286 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714285 0.35714285 0.35714286]
  [0.35714286 0.35714286 0.35714286 0.35714285 0.35714285 0.35714286
   0.35714286 0.35714286 0.35714285 0.35714286 0.35714286 0.35714286
   0.35714286 0.35714286 0.35714286]
  [0.35714285 0.35714285 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714286 0.35714286 0.35714285 0.35714285 0.35714285 0.35714286
   0.35714286 0.35714287 0.35714287]
  [0.35714285 0.35714285 0.35714286 0.35714286 0.35714286 0.35714285
   0.35714285 0.35714286 0.35714286 0.35714285 0.35714285 0.35714286
   0.35714286 0.35714287 0.35714287]
  [0.35714285 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714285 0.35714285 0.35714286 0.35714286 0.35714285 0.35714286
   0.35714287 0.35714286 0.35714286]
  [0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714286 0.35714285 0.35714286 0.35714286 0.35714285 0.35714285
   0.35714286 0.35714286 0.35714285]
  [0.35714286 0.35714286 0.35714286 0.35714285 0.35714286 0.35714286
   0.35714287 0.35714286 0.35714285 0.35714285 0.35714286 0.35714285
   0.35714285 0.35714286 0.35714286]
  [0.35714286 0.35714286 0.35714286 0.35714286 0.35714286 0.35714286
   0.35714286 0.35714286 0.35714286 0.35714285 0.35714286 0.35714285
   0.35714285 0.35714285 0.35714285]]]

qy: (1, 10, 15)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 3 
 shape : (1, 10, 15) 
 size(bytes) : 8 
 size(elements) : 150
[[[ 0.00000000e+00  5.47633050e-10  7.50866036e-12 -1.00981623e-09
   -1.53560009e-09 -8.93553675e-10  2.87018409e-09  1.05430837e-08
    1.47557371e-08  8.12601186e-09  4.20858903e-10  1.66894321e-09
    4.89590590e-09  5.71419445e-09  0.00000000e+00]
  [ 0.00000000e+00  5.43539436e-10  8.54491589e-10  2.06802397e-09
    3.72881459e-09  3.38642092e-09  1.03656950e-09  1.75400272e-09
    6.03943651e-09  6.14190743e-09  3.57975916e-09  6.56130039e-09
    9.53989865e-09  7.52138662e-09  0.00000000e+00]
  [ 0.00000000e+00  6.91943391e-10  1.86103044e-09  4.83698237e-09
    8.76451445e-09  9.74681047e-09  4.02223854e-09 -3.16989590e-09
   -1.20540644e-09  6.99057878e-09  1.08003615e-08  1.34577243e-08
    1.34282678e-08  8.25992919e-09  0.00000000e+00]
  [ 0.00000000e+00  1.39541267e-09  2.75352452e-09  3.49437812e-09
    3.80157950e-09  5.19847188e-09  5.56624391e-09  1.45992685e-09
    5.92713878e-10  8.73039330e-09  1.47507939e-08  1.49993009e-08
    1.11664762e-08  5.95146332e-09  0.00000000e+00]
  [ 0.00000000e+00  1.48180401e-09  2.84630985e-09  2.11817763e-09
   -1.27107391e-09 -2.88448909e-09  1.54385305e-09  4.45305082e-09
    2.14465024e-09  3.12278559e-09  7.03745329e-09  7.94326427e-09
    4.83928586e-09  2.62405475e-09  0.00000000e+00]
  [ 0.00000000e+00 -1.52249768e-10 -4.79487561e-10 -1.24683552e-09
   -2.99411163e-09 -5.73222803e-09 -3.64090491e-09  1.97418881e-09
    2.17832863e-10 -4.28550528e-09 -4.40030812e-09 -1.86558724e-09
   -4.82911977e-09 -4.75692685e-09  0.00000000e+00]
  [ 0.00000000e+00 -1.60843427e-09 -2.96047187e-09 -2.56772736e-09
   -5.72208059e-10 -3.13721937e-09 -9.26611987e-09 -7.99172506e-09
   -6.16383966e-09 -8.32303249e-09 -1.31341396e-08 -9.14399534e-09
   -5.49348167e-09 -7.28141591e-09  0.00000000e+00]
  [ 0.00000000e+00 -2.46356535e-09 -3.95433553e-09 -3.08912806e-09
    1.89291249e-10  7.32352845e-10 -7.39661310e-09 -1.37140770e-08
   -1.39238296e-08 -9.43181933e-09 -1.25264670e-08 -1.39834171e-08
   -3.06157011e-09 -4.16186641e-10  0.00000000e+00]
  [ 0.00000000e+00 -9.88087834e-10 -1.73246573e-09 -3.12913340e-09
   -4.17634727e-09 -2.74673351e-09 -3.69824837e-09 -7.74172815e-09
   -1.20199997e-08 -1.00885398e-08 -6.53736354e-09 -1.19671197e-08
   -8.38436565e-09 -6.92109925e-10  0.00000000e+00]
  [ 0.00000000e+00  1.05580966e-09  1.68792802e-09 -9.46094758e-10
   -5.49697710e-09 -6.10685191e-09 -3.05696002e-09 -1.30559563e-09
   -5.58576119e-09 -1.07803562e-08 -6.05407369e-09 -9.17450382e-09
   -1.19560513e-08 -5.06436226e-09  0.00000000e+00]]]</code></pre>
</div>
</div>
<div id="e6523784-d9b9-4ee1-aaf4-88343c970a44" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas del centro de celdas para graficación</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>x, y, z <span class="op">=</span> o_gwf.modelgrid.xyzcellcenters</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">x:"</span>, x.shape)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(x)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">y:"</span>, y.shape)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>xmf6.info_array(y)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
x: (10, 15)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 2 
 shape : (10, 15) 
 size(bytes) : 8 
 size(elements) : 150
[[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]
 [ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5 10.5 11.5 12.5 13.5
  14.5]]

y: (10, 15)
 tipo  : &lt;class 'numpy.ndarray'&gt; 
 dtype : float64 
 dim   : 2 
 shape : (10, 15) 
 size(bytes) : 8 
 size(elements) : 150
[[9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5 9.5]
 [8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5]
 [7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5 7.5]
 [6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5 6.5]
 [5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.5]
 [4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5 4.5]
 [3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5 3.5]
 [2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5 2.5]
 [1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5]
 [0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5]]</code></pre>
</div>
</div>
</section>
<section id="visualización-de-la-descarga-específica." class="level3" data-number="5.9.4">
<h3 data-number="5.9.4" class="anchored" data-anchor-id="visualización-de-la-descarga-específica."><span class="header-section-number">5.9.4</span> Visualización de la descarga específica.</h3>
<p>En este caso, se usan los mismos objetos que en la graficación de la carga hidráulica y solo se agregan los vectors de la descarga hidráulica.</p>
<div class="alert alert-block alert-info">
<p><strong>Observación</strong>.</p>
<p>Para dibujar los vectores usamos la función <code>quiver()</code> de matplotlib, pues ya tenemos los arreglos <code>x</code>, <code>y</code>, <code>qx</code> y <code>qy</code> en el formato adecuado para graficarlos en 2D.</p>
</div>
<div id="2fb3d6c5-c840-4e5c-b17f-781ebfa85826" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span>fig.gca()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>mapview <span class="op">=</span> flopy.plot.PlotMapView(model<span class="op">=</span>o_gwf, ax<span class="op">=</span>ax)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la carga hidráulica usando un mapa de color.</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>cb <span class="op">=</span> mapview.plot_array(head, cmap<span class="op">=</span><span class="st">"viridis"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de los vectores de la descarga específica.</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>ax.quiver(x, y, qx[<span class="dv">0</span>], qy[<span class="dv">0</span>], scale<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'k'</span>, pivot<span class="op">=</span><span class="st">'middle'</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualización de la malla, con una transparencia.</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>mapview.plot_grid(linewidths<span class="op">=</span><span class="fl">0.5</span>, alpha <span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Barra de color.</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>plt.colorbar(cb, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">"h (m)"</span>, cax <span class="op">=</span> xmf6.vis.cax(ax, cb))</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalización de la gráfica.</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Vectores de flujo sobre carga hidráulica (capa 1)"</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"X (m)"</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Y (m)"</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02_MF6_GWF_paq_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="referencias" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Referencias</h1>
<p>[1] Langevin, C.D., Hughes, J.D., Provost, A.M., Banta, E.R., Niswonger, R.G., and Panday, Sorab, 2017, Documentation for the MODFLOW 6 Groundwater Flow (GWF) Model: U.S. Geological Survey Techniques and Methods, book 6, chap.&nbsp;A55, 197 p., accessed August 4, 2017. https://doi.org/10.3133/tm6A55.</p>
<p>[2] MODFLOW 6 – Description of Input and Output. Version mf6.4.4—February 13, 2024. U.S. Department of the Interior. U.S. Geological Survey.. Archivo: mf6io.pdf de la documentación de MODFLOW 6 que se puede obtener de https://github.com/MODFLOW-ORG/modflow6/releases.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_MF6_GWF_init.html" class="pagination-link" aria-label="MODFLOW 6: inicializando una simulación.">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">MODFLOW 6: inicializando una simulación.</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_MF6_GWF_v1.html" class="pagination-link" aria-label="MODFLOW 6: simulación de flujo v 1.0">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">MODFLOW 6: simulación de flujo v 1.0</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>